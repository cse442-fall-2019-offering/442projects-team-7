<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="pos.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="title">RPi Point of Sale - Cashier Default Window</title>
    <script>
     
    </script>
    
  </head>
  <body>
    <div id="Nav-wrapper">
      <div id="navbar">
      </div>
    </div>
    <div id="CSI-wrapper">
      <div id="Create Sale Interface">

        <div id="Sale-Page-Navbar">
		  <button class="navButton" onclick="popUp('custLookup');" id="custLookup">Customer Lookup</button>
		  <button class="navButton" onclick="popUp('itemManip');" value="Edit Items" id="itemManip">Edit Items</button>
	      <script src="../main.js"></script>
        </div>

        <section>
          <div id="Transaction-Info-Panel">
            <div id="Inner-Transaction-Panel">
                <input id="Item-Search-Field" type="text" name="search_text" placeholder="Enter a SKU, scan barcode, or search for item...">
                <button class="tableButton" type="button" onclick="requestProductRow(document.getElementById('Item-Search-Field').value); updateTotals();" id ="searchItem">Search Item</button>
                <button class="tableButton" type="button" onclick="deleteProductRow(); updateTotals();">Delete Item</button>
            </div>
          </div>

          <table id="Item-List-Panel">
            <thead id="Column-Headers">
              <tr>
                <th id="SKU-Column">SKU</th>
                <th id="Description-Column">Description</th>
                <th id="Unit-Price-Column">Unit Price</th>
                <th id="Quantity-Column">Qty</th>
                <th id="Total-Column">Total</th>
              </tr>
            </thead>
            <tbody id="Table-Data">
            	<tr id="row_1" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_1_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_2" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_2_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_3" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_3_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_4" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_4_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_5" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_5_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_6" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_6_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_7" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_7_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_8" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_8_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_9" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_9_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_10" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_10_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_11" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_11_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_12" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_12_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_13" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_13_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_14" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_14_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_15" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_15_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_16" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_16_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_17" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_17_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_18" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_18_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_19" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_19_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_20" class="tableEntryB">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_20_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>
            	<tr id="row_21" class="tableEntryA">
            		<td class="tableColumn1"></td>
            		<td class="tableColumn2"></td>
            		<td class="tableColumn3"></td>
            		<td class="tableColumn4"><input type="number" id="row_21_qty_input" class="qty_input" disabled="true" min="0" onChange="updateProductTotal(this.value, this.id); updateTotals();"></td>
            		<td class="tableColumn5"></td>
            	</tr>

            </tbody>
          </table>
        <script type="text/javascript">
            document.getElementById("Table-Data").addEventListener('click', (e) => {
                var rowID = e.target.closest('tr').id;
                var row = document.getElementById(rowID);
                console.log(e.target.closest('tr').id);
                console.log(row);

                if (row.classList.contains('selectedRow')) {
                    // Check to see if the input was selected
                    if (row.cells[3].children[0] !== document.activeElement) {
                        row.classList.remove('selectedRow');
                        // Disable QTY input
                        row.cells[3].children[0].disabled = true;
                        console.log('already selected');
                    }
                } else {
                    row.classList.add('selectedRow');
                    // Enable QTY input
                    if (row.cells[0].innerHTML != '') {
                        row.cells[3].children[0].disabled = false;
                    }
                    console.log('newly selected');
                }
            });
        </script>

          <div id="Sale-Overview">
            <div id="Customer-Info">

            </div>
            <div id="Totals">
       
				<p>Subtotal: <span id="subtotal">$0.00</span></p>
				<p>Discounts: <span id="discounts">$0.00</span></p>
				<p>Tax: <span id="tax">$0.00</span></p>
				<br>
				<p>Total: <span id="total">$0.00</span></p>
			</div>
			<script>
				function updateTotals(){
					//whenever somthing gets added to the table, add it to the total sum.
				    console.log("updateTotals()");
				    var table = document.getElementById("Table-Data"), sumVal = 0;
				    for(var i = 0; i < table.rows.length; i++){
					if (table.rows[i].cells[4].innerHTML == '') { console.log("empty row"); }
					else {
					    sumVal += parseFloat(table.rows[i].cells[4].innerHTML);
					    console.log("attempted to parse " + table.rows[i].cells[4].innerHTML);
					}
				    }
				    
				    let subtotal = sumVal.toFixed(2);
				    subtotal = "$".concat(subtotal.toString());
				    let tax = (sumVal * 0.08).toFixed(2);
				    tax =  "$".concat(tax.toString());
				    let total = (sumVal * 1.08).toFixed(2);
				    total =  "$".concat(total.toString());
				    document.getElementById("subtotal").innerHTML = subtotal;
				    document.getElementById("tax").innerHTML = tax;
				    document.getElementById("total").innerHTML = total;
				}
			</script>
          </div>
        </section>

        <aside id="Quick-Buttons">
	  <div class="qbtns">
	    <p class="btn-group">Base</p>
	    <div class="qbtn-group">
	      <button onClick="requestProductRow(1); updateTotals();">Taco</button>
	      <button onClick="requestProductRow(2); updateTotals();">Burrito</button>
	      <button onClick="requestProductRow(3); updateTotals();">Bowl</button>
	    </div>
	    <p class="btn-group">Protein</p>
	    <div class="qbtn-group">
	      <button onClick="requestProductRow(15); updateTotals();">Braised Beef</button>
	      <button onClick="requestProductRow(16); updateTotals();">Grilled Chicken</button>
	      <button onClick="requestProductRow(17); updateTotals();">Slow Roasted Pork</button>
	    </div>
	    <p class="btn-group">Sides</p>
	    <div class="qbtn-group">
	      <button onClick="requestProductRow(5); updateTotals();">Poppin' Spring Rolls</button>
	      <button onClick="requestProductRow(6); updateTotals();">Chorizo Mackin' Cheese</button>
	      <button onClick="requestProductRow(7); updateTotals();">Reg Nach</button>
	    </div>
	    <p class="btn-group">Drinks</p>
	    <div class="qbtn-group">

	      <button onClick="requestProductRow(9); updateTotals();">Mexican Coca-Cola</button>
	      <button onClick="requestProductRow(10); updateTotals();">Jarritos</button>
	      <button onClick="requestProductRow(12); updateTotals();">Spring Water</button>
	    </div>
	  </div>
	  <br>
	  <p class="btn-group">Utility</p>
	  <div class="ubtns">
	    <div class="ubtn-group">
	      <button>Utility Button</button>
	      <button>Utility Button</button>
	      <button>Utility Button</button>
	    </div>
	   <!-- <br>
	    <div class="ubtn-group">
	      <button>Utility Button</button>
	      <button>Utility Button</button>
	      <button>Utility Button</button>
	    </div>
	    <br>
	  </div>
	  -->
	  <p class="btn-group">Payment</p>
	  <div class="pbtns">
	    <div class="pbtn-group">
	      <button>Payment Button</button>
	      <button>Payment Button</button>
	      <button>Payment Button</button>
	    </div>
	  </div>
        </aside>
      </div>
    </div>
  </body>
